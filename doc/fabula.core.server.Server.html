<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>fabula.core.server.Server : API documentation</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
    
    
  </head>
  <body>
    <h1 class="class">f.c.s.Server(<a href="fabula.core.Engine.html">fabula.core.Engine</a>) : class documentation</h1>
    <p>
      <span id="part">Part of <a href="fabula.html">fabula</a>.<a href="fabula.core.html">core</a>.<a href="fabula.core.server.html">server</a></span>
      
      <a href="classIndex.html#fabula.core.server.Server">View In Hierarchy</a>
    </p>
    <div>
      
    </div>
    <pre>The Server is the central management and control authority in Fabula.
It relies on the ServerInterface and the Plugin.

Additional attributes:

Server.interval
    1.0 / framerate

Server.action_time
    The time between actions that do not happen instantly.
    Used by the Server Plugin.

Server.room_by_id
    A collections.OrderedDict, mapping room identifiers to Room instances.

Server.room_by_client
    A dict, mapping client identifiers to Room instances.

Server.message_for_all
    Message to be broadcasted to all clients

Server.exit_requested
    Flag to be changed by signal handler</pre>

    
    
    <div id="splitTables">
      <table class="children sortable" id="id71">
  
  
<tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#__init__">__init__</a></td>
    <td><tt>Initialise the Server. If threadsafe is True (default), no signal handlers are installed.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#run">run</a></td>
    <td><span class="undocumented">No summary</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#call_plugin">call_plugin</a></td>
    <td><tt>Call Plugin and process Plugin message. Auxiliary method.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#handle_exit">handle_exit</a></td>
    <td><tt>Callback to stop the Server when an according OS signal is received.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_TriesToMoveEvent">process_TriesToMoveEvent</a></td>
    <td><tt>Perform sanity checks on target and either confirm, reject or forward to Plugin.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_InitEvent">process_InitEvent</a></td>
    <td><tt>Check if we already have a room and entities. If yes, send the data. If not, pass on to the plugin.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_TriesToLookAtEvent">process_TriesToLookAtEvent</a></td>
    <td><tt>Check what is being looked at, forward the Event and issue an according LookedAtEvent.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_TriesToTalkToEvent">process_TriesToTalkToEvent</a></td>
    <td><tt>Check who is being talked to and forward the Event.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_TriesToManipulateEvent">process_TriesToManipulateEvent</a></td>
    <td><tt>Check what is being manipulated, replace event.target_identifier with the identifier of the Entity to be manipulated, then let the Plugin handle the Event.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_TriesToPickUpEvent">process_TriesToPickUpEvent</a></td>
    <td><tt>Check what is being picked up, replace event.target_identifier with the identifier of the Entity to be picked up, then let the Plugin handle the Event.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_TriesToDropEvent">process_TriesToDropEvent</a></td>
    <td><tt>Perform checks and either forward the Event to the Plugin or issue AttemptFailedEvent.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_EnterRoomEvent">process_EnterRoomEvent</a></td>
    <td><tt>Register the client in the room and forward the Event. If the room does not exist, it will be created.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_MovesToEvent">process_MovesToEvent</a></td>
    <td><tt>Let the according room process the event and pass it on.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_PicksUpEvent">process_PicksUpEvent</a></td>
    <td><tt>Save the Entity to be picked up in Engine.rack, delete it from respective room and pass the PicksUpEvent on.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_DropsEvent">process_DropsEvent</a></td>
    <td><tt>Respawn the Entity to be dropped in the respective room, delete it from Engine.rack and pass the PicksUpEvent on.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_ChangePropertyEvent">process_ChangePropertyEvent</a></td>
    <td><tt>Let the Entity handle the Event. Then add the event to the message.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_SpawnEvent">process_SpawnEvent</a></td>
    <td><tt>Let the first room process the event and pass it on.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_DeleteEvent">process_DeleteEvent</a></td>
    <td><tt>Delete the Entity from the respective room and pass the DeleteEvent on.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_ChangeMapElementEvent">process_ChangeMapElementEvent</a></td>
    <td><tt>Let the Room instance process the Event and add it to message.</tt></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="fabula.core.server.Server.html#process_ExitEvent">process_ExitEvent</a></td>
    <td><tt>Handle ExitEvent. Items that the player has picked up will be kept in self.rack.</tt></td>
  </tr>
  
</table>
      
        <p>
          Inherited from <a href="fabula.core.Engine.html">Engine</a>:
        </p>
        <table class="children sortable" id="id72">
  
  
<tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#set_plugin">set_plugin</a></td>
    <td><tt>Set the Plugin which controls or presents the game. plugin_instance must be an instance of fabula.plugins.Plugin.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_ManipulatesEvent">process_ManipulatesEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_CanSpeakEvent">process_CanSpeakEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_AttemptFailedEvent">process_AttemptFailedEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_PerceptionEvent">process_PerceptionEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_SaysEvent">process_SaysEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_PassedEvent">process_PassedEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_LookedAtEvent">process_LookedAtEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_PickedUpEvent">process_PickedUpEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_DroppedEvent">process_DroppedEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_RoomCompleteEvent">process_RoomCompleteEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.core.Engine.html#process_ServerParametersEvent">process_ServerParametersEvent</a></td>
    <td><tt>Process the Event. The default implementation adds the event to the message.</tt></td>
  </tr>
  
</table>
      
        <p>
          Inherited from <a href="fabula.eventprocessor.EventProcessor.html">EventProcessor</a> (via <a href="fabula.core.Engine.html">Engine</a>):
        </p>
        <table class="children sortable" id="id73">
  
  
<tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.eventprocessor.EventProcessor.html#__getstate__">__getstate__</a></td>
    <td><tt>Return a copy of self.__dict__ with un-pickleable items removed to the pickle module.</tt></td>
  </tr><tr class="basemethod">
    
    
    <td>Method</td>
    <td><a href="fabula.eventprocessor.EventProcessor.html#__setstate__">__setstate__</a></td>
    <td><tt>Update self.__dict__ with state_dict provided by the pickle module, then call __init__().</tt></td>
  </tr>
  
</table>
      
      
    </div>
    
    
    

    <div class="function">
  <a name="fabula.core.server.Server.__init__">
    
  </a>
  <a name="__init__">
    
  </a>
  <div class="functionHeader">
    
    def
    __init__(self, interface_instance, framerate, action_time, threadsafe=True):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#__init__">fabula.core.Engine.__init__</a></div>
    <pre>Initialise the Server.
If threadsafe is True (default), no signal handlers are installed.</pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.run">
    
  </a>
  <a name="run">
    
  </a>
  <div class="functionHeader">
    
    def
    run(self):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#run">fabula.core.Engine.run</a></div>
    <pre>Main loop of the Server.
This is a blocking method. It calls all the process methods to
process events, and then the plugin.
This method will print usage information and status reports to STDOUT.</pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.call_plugin">
    
  </a>
  <a name="call_plugin">
    
  </a>
  <div class="functionHeader">
    
    def
    call_plugin(self, connector):
    
  </div>
  <div class="functionBody">
    
    <pre>Call Plugin and process Plugin message.
Auxiliary method.</pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.handle_exit">
    
  </a>
  <a name="handle_exit">
    
  </a>
  <div class="functionHeader">
    
    def
    handle_exit(self, signalnum, frame):
    
  </div>
  <div class="functionBody">
    
    <pre>Callback to stop the Server when an according OS signal is received.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_TriesToMoveEvent">
    
  </a>
  <a name="process_TriesToMoveEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_TriesToMoveEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_TriesToMoveEvent">fabula.core.Engine.process_TriesToMoveEvent</a></div>
    <pre>Perform sanity checks on target and either confirm, reject or forward to Plugin.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_InitEvent">
    
  </a>
  <a name="process_InitEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_InitEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_InitEvent">fabula.core.Engine.process_InitEvent</a></div>
    <pre>Check if we already have a room and entities. If yes, send the data. If not, pass on to the plugin.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_TriesToLookAtEvent">
    
  </a>
  <a name="process_TriesToLookAtEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_TriesToLookAtEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_TriesToLookAtEvent">fabula.core.Engine.process_TriesToLookAtEvent</a></div>
    <pre>Check what is being looked at, forward the Event and issue an according LookedAtEvent.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_TriesToTalkToEvent">
    
  </a>
  <a name="process_TriesToTalkToEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_TriesToTalkToEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_TriesToTalkToEvent">fabula.core.Engine.process_TriesToTalkToEvent</a></div>
    <pre>Check who is being talked to and forward the Event.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_TriesToManipulateEvent">
    
  </a>
  <a name="process_TriesToManipulateEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_TriesToManipulateEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_TriesToManipulateEvent">fabula.core.Engine.process_TriesToManipulateEvent</a></div>
    <pre>Check what is being manipulated,
replace event.target_identifier with the identifier of the Entity
to be manipulated, then let the Plugin handle the Event.</pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_TriesToPickUpEvent">
    
  </a>
  <a name="process_TriesToPickUpEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_TriesToPickUpEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_TriesToPickUpEvent">fabula.core.Engine.process_TriesToPickUpEvent</a></div>
    <pre>Check what is being picked up, replace event.target_identifier with the identifier of the Entity to be picked up, then let the Plugin handle the Event.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_TriesToDropEvent">
    
  </a>
  <a name="process_TriesToDropEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_TriesToDropEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_TriesToDropEvent">fabula.core.Engine.process_TriesToDropEvent</a></div>
    <pre>Perform checks and either forward the Event to the Plugin or issue AttemptFailedEvent.

If the target tile is not in Room.floor_plan, the attempt fails.
If the tile is not FLOOR, the attempt fails.
If the item is not in Rack (but in Room), the event is forwarded to the Plugin to decide what to do.
If the Entity who tries to drop the item from Rack does not own it, the attempt fails.
If there is another Entity on the tile, it is marked as the target.
In any other case, the Event is forwarded to the Plugin.</pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_EnterRoomEvent">
    
  </a>
  <a name="process_EnterRoomEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_EnterRoomEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.core.Engine.html#process_EnterRoomEvent">fabula.core.Engine.process_EnterRoomEvent</a></div>
    <pre>Register the client in the room and forward the Event.
If the room does not exist, it will be created.</pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_MovesToEvent">
    
  </a>
  <a name="process_MovesToEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_MovesToEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_MovesToEvent">fabula.eventprocessor.EventProcessor.process_MovesToEvent</a></div>
    <pre>Let the according room process the event and pass it on.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_PicksUpEvent">
    
  </a>
  <a name="process_PicksUpEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_PicksUpEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_PicksUpEvent">fabula.eventprocessor.EventProcessor.process_PicksUpEvent</a></div>
    <pre>Save the Entity to be picked up in Engine.rack, delete it from respective room and pass the PicksUpEvent on.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_DropsEvent">
    
  </a>
  <a name="process_DropsEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_DropsEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_DropsEvent">fabula.eventprocessor.EventProcessor.process_DropsEvent</a></div>
    <pre>Respawn the Entity to be dropped in the respective room, delete it from Engine.rack and pass the PicksUpEvent on.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_ChangePropertyEvent">
    
  </a>
  <a name="process_ChangePropertyEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_ChangePropertyEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_ChangePropertyEvent">fabula.eventprocessor.EventProcessor.process_ChangePropertyEvent</a></div>
    <pre>Let the Entity handle the Event. Then add the event to the message.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_SpawnEvent">
    
  </a>
  <a name="process_SpawnEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_SpawnEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_SpawnEvent">fabula.eventprocessor.EventProcessor.process_SpawnEvent</a></div>
    <pre>Let the first room process the event and pass it on.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_DeleteEvent">
    
  </a>
  <a name="process_DeleteEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_DeleteEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_DeleteEvent">fabula.eventprocessor.EventProcessor.process_DeleteEvent</a></div>
    <pre>Delete the Entity from the respective room and pass the DeleteEvent on.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_ChangeMapElementEvent">
    
  </a>
  <a name="process_ChangeMapElementEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_ChangeMapElementEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_ChangeMapElementEvent">fabula.eventprocessor.EventProcessor.process_ChangeMapElementEvent</a></div>
    <pre>Let the Room instance process the Event and add it to message.
        </pre>
  </div>
</div><div class="function">
  <a name="fabula.core.server.Server.process_ExitEvent">
    
  </a>
  <a name="process_ExitEvent">
    
  </a>
  <div class="functionHeader">
    
    def
    process_ExitEvent(self, event, **kwargs):
    
  </div>
  <div class="functionBody">
    <div class="interfaceinfo">overrides <a href="fabula.eventprocessor.EventProcessor.html#process_ExitEvent">fabula.eventprocessor.EventProcessor.process_ExitEvent</a></div>
    <pre>Handle ExitEvent.
Items that the player has picked up will be kept in self.rack.</pre>
  </div>
</div>
    <address>
      <a href="index.html">API Documentation</a> for fabula, generated by <a href="http://codespeak.net/~mwh/pydoctor/">pydoctor</a> at 2013-08-16 12:32:28.
    </address>
  </body>
</html>